## 고찰

테스트 하기 좋은코드, 테스트하기 좋게 코드짜는 법
등등 기본지식은 어느정도 천천히 머리에 넣어왔다.
이전 sns 프로젝트에 적용해볼 까 했지만, db i/o가 대부분인 코드여서 망설였는데, 이번에 확실히 기본이 되는 코드를
짜서 시작하면 테스팅 적용하기 쉬울것임.

먼저,

1- jest 기본 사용법 뚝딱 다시 해보고,
https://github.com/Hoontou/jestHandling 완.

2- docker로 몽고, pgdb 개발용으로 셋업하고, 완.

3- pg-mem typeorm
mongodb-memory-server mongoose 테스트 용으로 셋업하고 완.

4- 임의 스키마, 테이블 짠 후 테스트환경에서 전역에서 mock데이터 넣고 완
5- 각각 유닛테스트에서 잘 사용되는지, 완.

6- 모의 개발 연습까지.

db를 테스트한다는게, 자원 많이먹는다는거 알지만, 해보고 말하는거랑 안해보고 말하는거랑은 큰 차이가 있을거임.
또 tdd의 흑백, 장단에 대해서도.

하나 내 주관으로 확실한건, 유닛테스트 할 시간에 리팩토링 해라. <-완전 맞는말이라는거.
근데 이것도 테스트 툴 숙련도, 어떤코드에 유닛테스트 해야하는가?,
테스트 하기 쉬운 코딩스타일, 등등 많은 요소에 의해서 좌우될 수 있다는걸 알고있다.

내 주관으로 평가하기 위해선, 일단 해봐야하지 않겠나.

그리고 이왕 하는거 제대로, 이때까지 머리에 집어넣은것들이 아깝지 않게.

## 추가로,

혼자 할때는 상관없었지만,
이제 협업을 해야하니 제대로 정하고? 가야할점.

1. http api 규칙.
   제대로된 http api 명명규칙, param이나 설계법 등등 혼자하는게 아니니깐 제대로된 규칙으로
   헷갈리지 않게 해야함.
   쿼리스트링, 파라미터, 바디를 각각 어떤경우에?
   추가로)자동 문서화? https://jojoldu.tistory.com/783

2. err 처리.
   백엔드에서 자체적으로 테스트를 하지만, 주로 err는
   사용자 입력에서 시작하거나, 파생돼 나오니까
   프런트에 뭐 어디서 나온 err인지, 뭔일하다가 나온 err인지 등등 제대로 된 err를 던져줘야 내가 처리하기가 쉬울거임.

3. input validation
   유저한테 직접 값을 받는경우 + 필요에 따라,
   프런트에서 해달라고 하면, validation을 추가.

4. 컨트롤러의 인터페이스를 프런트와 공유.
   컨트롤러의 인터페이스를 만들어서 프런트와 공유하면 편할듯.

추가메모

1. 커서 pagenation에 대해 생각해본것.
   limit가 10일때, $gte로 11개를 가져온 후
   {doc: 앞 10개, nextStart: 11번째 objId} 로 하면
   엄청 깔끔할거같은데?
   가져온게 11개면 -> 10개, next까지 가능
   가져온게 10개 이하면 -> 이뒤에 더 없다는뜻, nextStart: falsy값으로. page 0 에 대한 표시와 안겹치게.
   오버헤드가 요청마다 +1 doc이라서 양호한 수준 아닌가? +1번의 find요청도 아니고.
